# ZAP Advanced Configuration for Angular XSS Application

# Scanner settings
scanner.attackStrength=HIGH
scanner.maxRuleDurationInMins=5
scanner.level=ATTACK

# AJAX Spider settings (for SPA applications like Angular)
ajax.browserid=chrome-headless
ajax.maxDuration=5
ajax.timeout=60
ajax.maxCrawlDepth=10
ajax.clickDefaultElems=true
ajax.clickElemsOnce=true
ajax.eventWait=2000

# Spider settings
spider.maxDepth=10
spider.maxDuration=5
spider.maxParseSizeBytes=2621440
spider.postForm=true
spider.processForm=true
spider.threadCount=10
spider.sendRefererHeader=true

# Authentication settings
authentication.loginUrl=http://localhost:4200/login
authentication.loginRequestData=username=admin@test.com&password=Password123
authentication.loggedInIndicator=\\Q"authenticated":true\\E

# Attack settings
rules.ascanrules.xss.strength=INSANE
rules.ascanrules.sqlinjection.strength=INSANE
rules.ascanrules.xss.threshold=LOW
rules.ascanrules.sqlinjection.threshold=LOW

# Include form-based authentication
spider.formFillMode=SPECIFY_FORM_FIELD_NAMES
spider.formFillNames=username,password,email
spider.formFillValues=admin@test.com,Password123,admin@test.com

# API configuration
api.disablekey=true
api.addrs.addr.name=.*
api.addrs.addr.regex=true

# Exclude URLs to improve performance
globalexcludeurl.url_list.url.1=.*\\.js$
globalexcludeurl.url_list.url.2=.*\\.css$
globalexcludeurl.url_list.url.3=.*\\.png$
globalexcludeurl.url_list.url.4=.*\\.jpg$
globalexcludeurl.url_list.url.5=.*\\.gif$
globalexcludeurl.url_list.url.6=.*\\.svg$
globalexcludeurl.url_list.url.7=.*favicon\\.ico$

# Include specifically vulnerable pages
includeInScope.url_list.url.1=http://localhost:4200/login
includeInScope.url_list.url.2=http://localhost:4200/signup
includeInScope.url_list.url.3=http://localhost:4200/profile
includeInScope.url_list.url.4=http://localhost:4200/user
includeInScope.url_list.url.5=http://localhost:4200/search
includeInScope.url_list.url.6=http://localhost:8000/api/
includeInScope.url_list.url.7=http://localhost:8000/login
includeInScope.url_list.url.8=http://localhost:8000/user
